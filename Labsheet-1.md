# COM-LAB-I-LabSheet-Week-15
# Project_65030289
# ลิงค์
https://github.com/AnchisaPhetnoi/Project_65030289.git
# ลิงค์สำรอง
https://github.com/AnchisaPhetnoi/Project_65030289
https://github.com/AnchisaPhetnoi/Project_65030289
# ส่งงาน 
## รูปภาพที่ 1
![ภาพ](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/1cca0d14-2651-42cd-971e-68de8b86916b)

## รูปภาพที่ 2
![ภาพ](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/132ca634-a42b-4a1b-983e-6e660ab2b284)
![ภาพ](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/b07215e8-ccf5-4da4-b286-86739be68809)

## รูปภาพที่ 3
![ภาพ](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/43ff1324-8ea5-4a27-a386-eceedea55366)
![ภาพ](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/7bdd6374-0120-4eb3-a402-2702d47b095e)
![ภาพ](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/d36c1eea-da3a-49d9-aa7b-46b4ecad35a5)
## รูปภาพที่ 4
![ภาพ](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/b8d483b9-8f16-4b48-8bcf-70628c393425)
![ภาพ](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/8c7c4fd5-0526-499b-8e1e-c8b554b5ffd9)
![ภาพ](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/3ba0d31a-bec8-4cc7-a076-d73330371f5d)
![ภาพ](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/203c0076-d931-4fd0-9b24-f020cbd10ed8)
## รูปภาพที่ 5
![393855128_816440213546335_6208027038037059078_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/0d0fd7e8-6f7d-4ca6-a125-025bb1c8d2f7)
![393525773_876176244066748_5006712557147155287_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/fb970368-4073-48ee-aee3-a4ea5b71bf3a)
![393813133_1109677186662895_8982608808495909772_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/844da45d-f6a7-4e13-b7d5-2bc35cbeefc8)
![393838737_300183439533066_1070408071558006534_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/e6615aec-c618-4219-87d9-6334eb8ab9f8)
![387556191_846432246980874_4914210427519601860_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/8cb626fd-f321-4692-8ec4-086b13a06233)
![393832642_286667987612152_4813515491822974675_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/6e8ca765-cbed-4e05-8545-e624cec49971)
## รูปภาพที่ 6
![393888604_662768015833493_7303583332928499498_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/6b122271-f8df-460d-b663-5d884082a7e2)
![393907685_862744211889815_7294988190732822172_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/2716a46b-e3f9-45d5-9c5b-d00aaa105530)
![393900193_338656565225091_8149359273047732097_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/9bfa2964-6c30-4686-a6c8-259d937c9625)
![387544013_345797714780207_1634664673674829894_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/0572eaa9-4292-41b9-9ca8-eb6f89b007e3)
![368281368_1815876448815010_285109492636123752_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/5d5588d5-cacc-4bd3-9690-1e4afaf306af)
![393971375_267982722340826_3358165320417803358_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/c5974254-c80b-416f-befd-1dc6224fe736)
![393512814_688896163172280_9136872002075864928_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/0651c1f7-0d70-45b2-b385-91a968c97c8a)
![394118504_830784145251956_6664835602240617645_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/6adc3f84-6d68-4e9f-a825-b6df0a074e2a)
![393774543_382518314104359_1574968454204316028_n](https://github.com/AnchisaPhetnoi/Project_65030289/assets/144197034/d0d7b230-06fb-493a-a3b5-12c916a59b96)

##  C# Unit test nd github CI/CD

18.ส่ง project ขึ้นบน  github

![Alt text](./Pictures/Picture-18.png)

1. คลิกขวาที่ชื่อ  Solution 'Project_6...... (2 of 2 Projects)' เลือก Create Git repository...
2. เลือก Local Path
3. ดูให้แน่ใจว่า Local path ที่เลือก มี folder ของ project ทั้งสองปรากฏอยู่
4. กด Select folder

19.Push และตามไปตรวจสอบบน github server 

![Alt text](./Pictures/Picture-19.png)

- เพื่อความสะดวก สามารถคลิก ... แล้วเลือก Open in Browser ได้

20.บน github server จะต้องเห็น folder ของโปรเจคทั้งสองอยู่ข้างกัน

![Alt text](./Pictures/Picture-20.png)

- กดปุ่ม  Actions

21.เลือก .NET Desktop กด Configure

![Alt text](./Pictures/Picture-21.png)

22.จะได้หน้าจอแบบนี้

![Alt text](./Pictures/Picture-22.png)

23.แก้ไข code ในไฟล์ dotnet-desktop.yml ให่้เป็นดังนี้

```yml
# This workflow uses actions that are not certified by GitHub.
# They are provided by a third-party and are governed by
# separate terms of service, privacy policy, and support
# documentation.

# This workflow will build, test, sign and package a WPF or Windows Forms desktop application
# built on .NET Core.
# To learn how to migrate your existing application to .NET Core,
# refer to https://docs.microsoft.com/en-us/dotnet/desktop-wpf/migration/convert-project-from-net-framework
#
# To configure this workflow:
#
# 1. Configure environment variables
# GitHub sets default environment variables for every workflow run.
# Replace the variables relative to your project in the "env" section below.
#
# 2. Signing
# Generate a signing certificate in the Windows Application
# Packaging Project or add an existing signing certificate to the project.
# Next, use PowerShell to encode the .pfx file using Base64 encoding
# by running the following Powershell script to generate the output string:
#
# $pfx_cert = Get-Content '.\SigningCertificate.pfx' -Encoding Byte
# [System.Convert]::ToBase64String($pfx_cert) | Out-File 'SigningCertificate_Encoded.txt'
#
# Open the output file, SigningCertificate_Encoded.txt, and copy the
# string inside. Then, add the string to the repo as a GitHub secret
# and name it "Base64_Encoded_Pfx."
# For more information on how to configure your signing certificate for
# this workflow, refer to https://github.com/microsoft/github-actions-for-desktop-apps#signing
#
# Finally, add the signing certificate password to the repo as a secret and name it "Pfx_Key".
# See "Build the Windows Application Packaging project" below to see how the secret is used.
#
# For more information on GitHub Actions, refer to https://github.com/features/actions
# For a complete CI/CD sample to get started with GitHub Action workflows for Desktop Applications,
# refer to https://github.com/microsoft/github-actions-for-desktop-apps

name: .NET Core Desktop

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:

 run-selected-unittests:
    runs-on: windows-latest
    env:
      ACTIONS_ALLOW_UNSECURE_COMMANDS: true
    name: Run MSBuild and VSTest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v2.1.0
        id: checkout_code
            
      - name: Setup MSBuild and add to PATH
        uses: microsoft/setup-msbuild@v1.0.0
        id: setup_msbuild
              
      - name: Run MSBuild
        id: run_msbuild
        run: |
          msbuild .\Project_6xxxxxxx\Project_6xxxxxxx.sln  /t:clean /p:Configuration=Debug
          nuget restore .\Project_6xxxxxxx\Project_6xxxxxxx.sln
          msbuild .\Project_6xxxxxxx\Project_6xxxxxxx.sln  /t:build /p:Configuration=Debug
     
      - name: Setup VSTest and add to PATH
        uses: darenm/Setup-VSTest@v1
        id: setup_vstest

      - name: Test Project Members
        id: run_vstest
        working-directory: .\TestProject\\bin\Debug\net6.0
        run: vstest.console.exe TestProject.dll /Tests:TestProjectMembersCount
```

24.commit สิ่งที่ได้แก้ไข ใน repository จะมี folder เพิ่มขึ้นมาเพื่อเป็นที่เก็บไฟล์ yml ที่ทำหน้าที่ CI/CD 

![Alt text](./Pictures/Picture-23.png)

25.กดปุ่ม  Actions ในหน้า repository

![Alt text](./Pictures/Picture-24.png)

- คลิกที่ Create dotnet-desktop.yml เพื่อดูความคืบหน้าในการทดสอบ

26.กระบวนการ CI/CD จะเริ่มทำงานตาม script ในไฟล์ yml ที่เราแก้ไขไป

![Alt text](./Pictures/Picture-25.png)

27.กระบวนการทดสอบ ควรจะมี error เช่นเดียวกับใน Visual studio

![Alt text](./Pictures/Picture-26.png)

28.กลับไปที่่ Visual studio

![Alt text](./Pictures/Picture-27.png)

- แก้ไข code ในไฟล์ Project.cs โดยการเพิ่มสมาชิกไปอีก 1 คน
- ทดสอบ โดยเรียกเมนู Test -> Run All Tests
- ควรจะได้ผลการทดสอบเป็นผ่าน ดังรูปด้านบน

29.ไปที่ git bash ใน Terminal view

![Alt text](./Pictures/Picture-28.png)

- git status

- git commit

- git push ซึ่งควรจะมี error เนื่องจากมีการ update ที่บน github server ดังนั้นต้องทำคำสั่ง git pull

- git pull

30.เมื่อ push ขึ้นบน server กระบวนการตรวจสอบอัตโนมัติจะเริ่มทำงาน

![Alt text](./Pictures/Picture-29.png)

- ตรวจสอบได้จากการกดปุ่ม Actions

### [>> ยังไม่จบ มีต่ออีกนิด >>](./Labsheet-2.md)
